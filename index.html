<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Streamline Objection Training Suite</title>

  <!-- React + Tailwind CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Brand fonts: Poppins (body/UI). 
       For Canela Text Black (headlines), set --font-display to your hosted font-family name. -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet"/>

  <style>
    :root{
      /* If you have Canela Text Black available, change this to: "Canela Text Black", "Canela Text", serif */
      --font-display: "Georgia", "Times New Roman", serif;
    }
    /* Smooth focus outline for a11y */
    :focus-visible { outline: 3px solid #6ED8FF; outline-offset: 2px; }
  </style>

  <script>
    /* Tailwind brand theme */
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Poppins', 'system-ui', 'Segoe UI', 'Helvetica', 'Arial', 'sans-serif'],
            display: ['var(--font-display)']
          },
          colors: {
            'fm-blue': '#1D3146',     // Web Blue (primary)
            'fm-gold': '#A18732',     // Brand Gold (accent)
            'fm-med-blue': '#00476A', // Medium Blue
            'fm-bright-blue': '#499CC9',
            'fm-light-blue': '#6ED8FF',
            'fm-dark-teal': '#00838F',
            'fm-teal': '#35CCBA'
          },
          boxShadow: {
            card: '0 6px 18px rgba(0,0,0,0.08)'
          },
          borderRadius: {
            xl2: '1rem'
          }
        }
      }
    }
  </script>
</head>
<body class="bg-fm-blue/4">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    /* ---------------- Icons (stroke inherits currentColor) ---------------- */
    const Volume2 = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
        <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
        <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
      </svg>
    );
    const Trophy = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
        <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
        <path d="M4 22h16"></path>
        <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
        <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
        <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
      </svg>
    );
    const Star = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
      </svg>
    );
    const Clock = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
    );
    const Users = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
      </svg>
    );
    const Zap = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
      </svg>
    );
    const RotateCcw = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="1 4 1 10 7 10"></polyline>
        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
      </svg>
    );
    const CheckCircle = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
    );
    const XCircle = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
      </svg>
    );

    /* ---------------- Data ---------------- */
    const objections = [
      { id: 1, text: "The savings is not enough", category: "Value", difficulty: "Medium" },
      { id: 2, text: "I don't want to go back to 30 years", category: "Terms", difficulty: "Medium" },
      { id: 3, text: "I want to wait for rates to go down more", category: "Timing", difficulty: "Hard" },
      { id: 4, text: "I've heard the Fed is going to drop interest rates", category: "Timing", difficulty: "Hard" },
      { id: 5, text: "I don't want to pay cost", category: "Cost", difficulty: "Easy" },
      { id: 6, text: "I received a better offer from another lender", category: "Competition", difficulty: "Hard" },
      { id: 7, text: "I don't feel like going through the process of refinancing", category: "Process", difficulty: "Medium" },
      { id: 8, text: "I am tired of getting calls from you guys about this, I'm not interested", category: "Resistance", difficulty: "Hard" },
      { id: 9, text: "I'm not interested", category: "Resistance", difficulty: "Easy" },
      { id: 10, text: "I need to speak with my spouse", category: "Stall", difficulty: "Medium" },
      { id: 11, text: "I already spoke to someone at your company about this, I'm not interested", category: "Resistance", difficulty: "Medium" },
      { id: 12, text: "I need time to think about it", category: "Timing", difficulty: "Medium" },
      { id: 13, text: "I only plan to stay in the home for a few more years, I don't think it's worth it", category: "Value", difficulty: "Medium" },
      { id: 14, text: "I don't want my credit ran", category: "Process", difficulty: "Easy" },
      { id: 15, text: "I had a bad experience with my last refinance", category: "Process", difficulty: "Hard" },
      { id: 16, text: "I received a letter in the mail from another lender offering me a lower rate", category: "Competition", difficulty: "Medium" },
      { id: 17, text: "I am going to call my local bank and see if they can offer me something lower", category: "Competition", difficulty: "Medium" },
      { id: 18, text: "I'm selling my home soon", category: "Circumstance", difficulty: "Medium" }
    ];

    /* ---------------- Game Selector ---------------- */
    const GameSelector = () => {
      const [selectedGame, setSelectedGame] = useState(null);
      const games = [
        { id: 'spinner', name: 'Objection Spinner', icon: RotateCcw, description: 'Spin the wheel for random objections' },
        { id: 'speed', name: 'Speed Challenge', icon: Zap, description: 'Race against the clock' },
        { id: 'jeopardy', name: 'Objection Jeopardy', icon: Trophy, description: 'Game show format' },
        { id: 'teams', name: 'Team Battle', icon: Users, description: 'Compete in teams' },
        { id: 'recipe', name: 'Recipe Cards', icon: Star, description: 'Create rebuttal recipes' },
        { id: 'feud', name: 'Family Feud', icon: Users, description: 'Top objections survey' },
        { id: 'millionaire', name: 'Who Wants to be a Millionaire', icon: Trophy, description: 'Answer your way to the top' },
        { id: 'matching', name: 'Drag & Match', icon: Zap, description: 'Match objections to rebuttals' }
      ];

      if (selectedGame === 'spinner') return <ObjectionSpinner onBack={() => setSelectedGame(null)} />;
      if (selectedGame === 'speed') return <SpeedChallenge onBack={() => setSelectedGame(null)} />;
      if (selectedGame === 'jeopardy') return <ObjectionJeopardy onBack={() => setSelectedGame(null)} />;
      if (selectedGame === 'teams') return <TeamBattle onBack={() => setSelectedGame(null)} />;
      if (selectedGame === 'recipe') return <RecipeCards onBack={() => setSelectedGame(null)} />;
      if (selectedGame === 'feud') return <FamilyFeud onBack={() => setSelectedGame(null)} />;
      if (selectedGame === 'millionaire') return <Millionaire onBack={() => setSelectedGame(null)} />;
      if (selectedGame === 'matching') return <DragMatch onBack={() => setSelectedGame(null)} />;

      return (
        <div className="min-h-screen bg-white">
          <header className="bg-fm-blue">
            <div className="max-w-6xl mx-auto px-6 py-10">
              <h1 className="font-display text-4xl md:text-5xl text-white tracking-tight">
                Streamline Objection Training
              </h1>
              <p className="mt-2 text-fm-light-blue/90">
                Choose a game to master objection handling
              </p>
            </div>
          </header>

          <main className="max-w-6xl mx-auto px-6 py-10">
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {games.map(game => {
                const Icon = game.icon;
                return (
                  <button
                    key={game.id}
                    onClick={() => setSelectedGame(game.id)}
                    className="bg-white rounded-xl2 shadow-card p-6 text-left border border-fm-med-blue/10 hover:border-fm-bright-blue/50 transition group focus-visible:ring-4 focus-visible:ring-fm-light-blue"
                  >
                    <div className="flex items-center gap-4">
                      <span className="inline-flex items-center justify-center w-14 h-14 rounded-full bg-fm-bright-blue/10 text-fm-bright-blue">
                        <Icon className="w-7 h-7" />
                      </span>
                      <div>
                        <h3 className="text-xl font-semibold text-fm-blue">{game.name}</h3>
                        <p className="text-fm-blue/70 text-sm">{game.description}</p>
                      </div>
                    </div>
                    <div className="mt-5">
                      <span className="inline-flex items-center gap-2 text-fm-gold font-medium">
                        Start <svg className="w-4 h-4" viewBox="0 0 20 20" fill="currentColor"><path d="M7 5l5 5-5 5"/></svg>
                      </span>
                    </div>
                  </button>
                );
              })}
            </div>
          </main>
        </div>
      );
    };

    /* ---------------- Objection Spinner ---------------- */
    const ObjectionSpinner = ({ onBack }) => {
      const [spinning, setSpinning] = useState(false);
      const [rotation, setRotation] = useState(0);
      const [selected, setSelected] = useState(null);

      const spin = () => {
        setSpinning(true);
        setSelected(null);
        const randomRotation = 360 * 5 + Math.random() * 360;
        setRotation(prev => prev + randomRotation);
        setTimeout(() => {
          const index = Math.floor(Math.random() * objections.length);
          setSelected(objections[index]);
          setSpinning(false);
        }, 3000);
      };

      // Build a brand wheel (segments in brand blues/teals)
      const segments = ['#1D3146','#00476A','#499CC9','#6ED8FF','#35CCBA','#00838F'];

      const conic = `conic-gradient(${segments.map((c,i)=>`${c} ${i*(100/segments.length)}% ${(i+1)*(100/segments.length)}%`).join(',')})`;

      return (
        <div className="min-h-screen bg-white">
          <div className="max-w-4xl mx-auto px-6 py-8">
            <button onClick={onBack} className="mb-6 px-4 py-2 rounded-lg border border-fm-med-blue/20 text-fm-blue hover:bg-fm-bright-blue/10">
              ‚Üê Back to Games
            </button>

            <div className="text-center mb-8">
              <h2 className="font-display text-4xl text-fm-blue">Objection Spinner</h2>
              <p className="text-fm-blue/70">Spin the wheel and respond to the objection</p>
            </div>

            <div className="bg-white rounded-xl2 shadow-card p-10 mb-6 border border-fm-med-blue/10">
              <div className="relative mx-auto" style={{ width: '320px', height: '320px' }}>
                <div
                  className="absolute inset-0 rounded-full border-8"
                  style={{
                    borderColor: '#A18732',
                    background: conic,
                    transform: `rotate(${rotation}deg)`,
                    transition: spinning ? 'transform 3s cubic-bezier(0.25, 0.1, 0.25, 1)' : 'none'
                  }}
                />
                <div className="absolute inset-0 flex items-center justify-center">
                  <div className="bg-white rounded-full w-24 h-24 flex items-center justify-center shadow-card border border-fm-med-blue/10">
                    <Volume2 className="w-10 h-10 text-fm-gold" />
                  </div>
                </div>
                <div className="absolute -top-2 left-1/2 -translate-x-1/2">
                  <div className="w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent" style={{borderTopColor:'#A18732'}} />
                </div>
              </div>

              <button
                onClick={spin}
                disabled={spinning}
                className="mt-8 w-full py-4 rounded-lg text-white font-semibold bg-fm-bright-blue hover:bg-fm-light-blue disabled:opacity-60 disabled:cursor-not-allowed"
              >
                {spinning ? 'SPINNING‚Ä¶' : 'SPIN THE WHEEL'}
              </button>
            </div>

            {selected && (
              <div className="bg-white rounded-xl2 shadow-card p-8 border border-fm-med-blue/10">
                <h3 className="text-lg font-semibold text-fm-blue mb-2">Your Objection</h3>
                <p className="text-2xl font-semibold text-fm-med-blue mb-4">‚Äú{selected.text}‚Äù</p>
                <div className="flex gap-2 mb-4">
                  <span className="bg-fm-bright-blue/10 text-fm-med-blue px-3 py-1 rounded">{selected.category}</span>
                  <span className={
                    `px-3 py-1 rounded ${
                      selected.difficulty === 'Easy' ? 'bg-fm-teal/15 text-fm-dark-teal' :
                      selected.difficulty === 'Medium' ? 'bg-amber-100 text-amber-800' :
                      'bg-rose-100 text-rose-700'
                    }`
                  }>
                    {selected.difficulty}
                  </span>
                </div>
                <p className="text-fm-blue/75">Now deliver your best rebuttal!</p>
              </div>
            )}
          </div>
        </div>
      );
    };

    /* ---------------- Speed Challenge ---------------- */
    const SpeedChallenge = ({ onBack }) => {
      const [timeLeft, setTimeLeft] = useState(60);
      const [score, setScore] = useState(0);
      const [currentObjection, setCurrentObjection] = useState(null);
      const [gameActive, setGameActive] = useState(false);
      const [usedObjections, setUsedObjections] = useState([]);

      useEffect(() => {
        if (gameActive && timeLeft > 0) {
          const t = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);
          return () => clearTimeout(t);
        } else if (timeLeft === 0) setGameActive(false);
      }, [timeLeft, gameActive]);

      const startGame = () => {
        setGameActive(true); setScore(0); setTimeLeft(60); setUsedObjections([]); nextObjection();
      };

      const nextObjection = () => {
        const available = objections.filter(o => !usedObjections.includes(o.id));
        const pool = available.length ? available : objections;
        const random = pool[Math.floor(Math.random() * pool.length)];
        setCurrentObjection(random);
        setUsedObjections(prev => [...prev, random.id]);
      };

      const handleResponse = (success) => {
        if (success) {
          setScore(score + (currentObjection.difficulty === 'Hard' ? 30 : currentObjection.difficulty === 'Medium' ? 20 : 10));
        }
        nextObjection();
      };

      return (
        <div className="min-h-screen bg-white">
          <div className="max-w-4xl mx-auto px-6 py-8">
            <button onClick={onBack} className="mb-6 px-4 py-2 rounded-lg border border-fm-med-blue/20 text-fm-blue hover:bg-fm-bright-blue/10">
              ‚Üê Back to Games
            </button>

            <div className="text-center mb-8">
              <h2 className="font-display text-4xl text-fm-blue">60-Second Speed Challenge</h2>
              <p className="text-fm-blue/70">How many objections can you handle in 60 seconds?</p>
            </div>

            <div className="bg-white rounded-xl2 shadow-card p-8 border border-fm-med-blue/10">
              <div className="flex justify-between items-center mb-8">
                <div className="text-center">
                  <Clock className="w-10 h-10 mx-auto mb-1 text-fm-bright-blue"/>
                  <p className="text-3xl font-semibold text-fm-med-blue">{timeLeft}s</p>
                </div>
                <div className="text-center">
                  <Trophy className="w-10 h-10 mx-auto mb-1 text-fm-gold"/>
                  <p className="text-3xl font-semibold text-fm-gold">{score}</p>
                </div>
              </div>

              {!gameActive && timeLeft === 60 && (
                <button onClick={startGame}
                        className="w-full py-5 rounded-lg text-white font-semibold bg-fm-bright-blue hover:bg-fm-light-blue">
                  Start Challenge
                </button>
              )}

              {gameActive && currentObjection && (
                <div>
                  <div className="rounded-lg p-6 mb-6 border border-fm-med-blue/10 bg-fm-bright-blue/5">
                    <p className="text-lg font-medium text-fm-blue mb-2">Customer says:</p>
                    <p className="text-2xl font-semibold text-fm-med-blue">‚Äú{currentObjection.text}‚Äù</p>
                    <p className="text-sm text-fm-blue/70 mt-2">
                      Points: {currentObjection.difficulty === 'Hard' ? '30' : currentObjection.difficulty === 'Medium' ? '20' : '10'}
                    </p>
                  </div>

                  <p className="text-center text-fm-blue/70 mb-4">Deliver your rebuttal, then mark the result.</p>

                  <div className="flex gap-4">
                    <button onClick={() => handleResponse(true)}
                            className="flex-1 py-4 rounded-lg text-white text-lg font-semibold bg-fm-dark-teal hover:bg-fm-teal flex items-center justify-center gap-2">
                      <CheckCircle className="w-6 h-6" /> Got It
                    </button>
                    <button onClick={() => handleResponse(false)}
                            className="flex-1 py-4 rounded-lg text-white text-lg font-semibold bg-rose-600 hover:bg-rose-700 flex items-center justify-center gap-2">
                      <XCircle className="w-6 h-6" /> Skip
                    </button>
                  </div>
                </div>
              )}

              {!gameActive && timeLeft === 0 && (
                <div className="text-center">
                  <h3 className="text-2xl font-semibold text-fm-blue mb-4">Time‚Äôs Up!</h3>
                  <p className="text-5xl font-bold text-fm-gold mb-6">{score} Points</p>
                  <button onClick={startGame}
                          className="px-8 py-4 rounded-lg text-white font-semibold bg-fm-bright-blue hover:bg-fm-light-blue">
                    Try Again
                  </button>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    };

    /* ---------------- Jeopardy ---------------- */
    const ObjectionJeopardy = ({ onBack }) => {
      const [selectedCell, setSelectedCell] = useState(null);
      const [answeredCells, setAnsweredCells] = useState([]);
      const [teamScores, setTeamScores] = useState({ team1: 0, team2: 0 });
      const [currentTeam, setCurrentTeam] = useState('team1');
      const [gameBoard, setGameBoard] = useState({});

      useEffect(() => { initializeBoard(); }, []);
      const initializeBoard = () => {
        const categories = {
          'Value': objections.filter(o => o.category === 'Value' || o.category === 'Cost'),
          'Timing': objections.filter(o => o.category === 'Timing'),
          'Process': objections.filter(o => o.category === 'Process' || o.category === 'Terms'),
          'Resistance': objections.filter(o => o.category === 'Resistance' || o.category === 'Stall' || o.category === 'Circumstance'),
          'Competition': objections.filter(o => o.category === 'Competition')
        };
        const board = {};
        Object.keys(categories).forEach(category => {
          const shuffled = [...categories[category]].sort(() => Math.random() - 0.5);
          board[category] = shuffled.slice(0, 3);
        });
        setGameBoard(board);
      };

      const pointValues = [100, 200, 300];
      const handleCellClick = (category, pointIndex) => {
        const cellKey = `${category}-${pointIndex}`;
        if (!answeredCells.includes(cellKey) && gameBoard[category]) {
          const objection = gameBoard[category][pointIndex];
          setSelectedCell({ category, points: pointValues[pointIndex], objection, cellKey });
        }
      };
      const handleAnswer = (correct) => {
        if (correct) setTeamScores(prev => ({ ...prev, [currentTeam]: prev[currentTeam] + selectedCell.points }));
        setAnsweredCells(prev => [...prev, selectedCell.cellKey]);
        setSelectedCell(null);
        setCurrentTeam(currentTeam === 'team1' ? 'team2' : 'team1');
      };
      const resetGame = () => { setAnsweredCells([]); setTeamScores({ team1:0, team2:0 }); setCurrentTeam('team1'); setSelectedCell(null); initializeBoard(); };

      if (Object.keys(gameBoard).length === 0) {
        return <div className="min-h-screen bg-white flex items-center justify-center p-8"><p className="text-fm-blue text-xl">Loading game‚Ä¶</p></div>;
      }

      return (
        <div className="min-h-screen bg-white">
          <div className="max-w-7xl mx-auto px-6 py-8">
            <button onClick={onBack} className="mb-6 px-4 py-2 rounded-lg border border-fm-med-blue/20 text-fm-blue hover:bg-fm-bright-blue/10">
              ‚Üê Back to Games
            </button>

            <div className="text-center mb-8">
              <h2 className="font-display text-4xl text-fm-blue">Objection Jeopardy</h2>
            </div>

            <div className="flex justify-around mb-8">
              <div className={`bg-white rounded-xl2 p-6 shadow-card border ${currentTeam==='team1' ? 'border-fm-gold' : 'border-fm-med-blue/10'}`}>
                <h3 className="text-xl font-semibold text-fm-blue mb-1">Team 1</h3>
                <p className="text-3xl font-bold text-fm-med-blue">${teamScores.team1}</p>
              </div>
              <div>
                <button onClick={resetGame}
                        className="px-6 py-3 rounded-lg text-white font-semibold bg-fm-gold hover:brightness-110">
                  New Game
                </button>
              </div>
              <div className={`bg-white rounded-xl2 p-6 shadow-card border ${currentTeam==='team2' ? 'border-fm-gold' : 'border-fm-med-blue/10'}`}>
                <h3 className="text-xl font-semibold text-fm-blue mb-1">Team 2</h3>
                <p className="text-3xl font-bold text-fm-med-blue">${teamScores.team2}</p>
              </div>
            </div>

            <div className="bg-fm-blue rounded-xl2 p-3">
              <div className="grid grid-cols-5 gap-2">
                {Object.keys(gameBoard).map(category => (
                  <div key={category} className="bg-fm-med-blue p-3 text-center rounded-lg">
                    <h3 className="text-base font-semibold text-white">{category}</h3>
                  </div>
                ))}
                {pointValues.map((points, pointIndex) =>
                  Object.keys(gameBoard).map(category => {
                    const cellKey = `${category}-${pointIndex}`;
                    const isAnswered = answeredCells.includes(cellKey);
                    return (
                      <button
                        key={cellKey}
                        onClick={() => handleCellClick(category, pointIndex)}
                        disabled={isAnswered}
                        className={`p-6 rounded-lg text-2xl font-bold transition ${
                          isAnswered
                            ? 'bg-fm-blue text-fm-blue cursor-not-allowed'
                            : 'bg-fm-bright-blue text-white hover:bg-fm-light-blue'
                        }`}
                      >
                        {isAnswered ? '' : `$${points}`}
                      </button>
                    );
                  })
                )}
              </div>
            </div>

            {selectedCell && (
              <div className="fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50">
                <div className="bg-white rounded-xl2 p-10 max-w-3xl w-full shadow-card border border-fm-med-blue/10">
                  <div className="text-center mb-8">
                    <p className="text-fm-gold text-3xl font-bold mb-3">${selectedCell.points}</p>
                    <p className="text-fm-med-blue text-2xl font-semibold">‚Äú{selectedCell.objection.text}‚Äù</p>
                  </div>
                  <p className="text-fm-blue/80 text-center mb-8">
                    {currentTeam === 'team1' ? 'Team 1' : 'Team 2'}, deliver your rebuttal!
                  </p>
                  <div className="flex gap-4">
                    <button onClick={() => handleAnswer(true)} className="flex-1 py-4 rounded-lg text-white font-semibold bg-fm-dark-teal hover:bg-fm-teal">Correct</button>
                    <button onClick={() => handleAnswer(false)} className="flex-1 py-4 rounded-lg text-white font-semibold bg-rose-600 hover:bg-rose-700">Incorrect</button>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    };

    /* ---------------- Team Battle ---------------- */
    const TeamBattle = ({ onBack }) => {
      const [teams, setTeams] = useState([
        { name: 'Team Alpha', score: 0, color: 'fm-med-blue' },
        { name: 'Team Beta', score: 0, color: 'fm-bright-blue' },
        { name: 'Team Gamma', score: 0, color: 'fm-dark-teal' },
        { name: 'Team Delta', score: 0, color: 'fm-gold' }
      ]);
      const [currentObjection, setCurrentObjection] = useState(null);
      const [activeTeam, setActiveTeam] = useState(0);

      const drawObjection = () => {
        const random = objections[Math.floor(Math.random() * objections.length)];
        setCurrentObjection(random);
      };
      const awardPoints = (teamIndex, points) => {
        setTeams(prev => prev.map((t, idx) => idx === teamIndex ? { ...t, score: t.score + points } : t));
        setCurrentObjection(null);
        setActiveTeam((activeTeam + 1) % teams.length);
      };

      return (
        <div className="min-h-screen bg-white">
          <div className="max-w-6xl mx-auto px-6 py-8">
            <button onClick={onBack} className="mb-6 px-4 py-2 rounded-lg border border-fm-med-blue/20 text-fm-blue hover:bg-fm-bright-blue/10">
              ‚Üê Back to Games
            </button>

            <div className="text-center mb-8">
              <h2 className="font-display text-4xl text-fm-blue">Team Battle Royale</h2>
              <p className="text-fm-blue/70">Compete for objection-handling supremacy!</p>
            </div>

            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
              {teams.map((team, idx) => (
                <div key={idx}
                     className={`rounded-xl2 p-6 text-white shadow-card border ${activeTeam===idx ? 'ring-4 ring-fm-gold' : 'border-transparent'}`}
                     style={{ backgroundColor: `var(--${team.color})` }}>
                  <style>{`
                    :root{
                      --fm-med-blue: #00476A;
                      --fm-bright-blue: #499CC9;
                      --fm-dark-teal: #00838F;
                      --fm-gold: #A18732;
                    }
                  `}</style>
                  <Trophy className="w-7 h-7 mx-auto mb-2 text-white"/>
                  <h3 className="text-lg font-semibold text-center">{team.name}</h3>
                  <p className="text-3xl font-bold text-center">{team.score}</p>
                </div>
              ))}
            </div>

            <div className="bg-white rounded-xl2 shadow-card p-8 border border-fm-med-blue/10">
              {!currentObjection ? (
                <div className="text-center">
                  <p className="text-xl text-fm-blue/75 mb-6">{teams[activeTeam].name}'s turn</p>
                  <button onClick={drawObjection}
                          className="px-10 py-5 rounded-lg text-white font-semibold bg-fm-bright-blue hover:bg-fm-light-blue">
                    Draw Objection
                  </button>
                </div>
              ) : (
                <div>
                  <div className="rounded-lg p-6 mb-6 border border-fm-med-blue/10 bg-fm-bright-blue/5">
                    <p className="text-base text-fm-blue/70 mb-2">Objection for {teams[activeTeam].name}:</p>
                    <p className="text-2xl font-semibold text-fm-med-blue">‚Äú{currentObjection.text}‚Äù</p>
                    <div className="flex gap-2 mt-4">
                      <span className="bg-fm-light-blue/20 text-fm-med-blue px-3 py-1 rounded">{currentObjection.category}</span>
                      <span className={
                        `px-3 py-1 rounded ${
                          currentObjection.difficulty === 'Easy' ? 'bg-fm-teal/15 text-fm-dark-teal' :
                          currentObjection.difficulty === 'Medium' ? 'bg-amber-100 text-amber-800' :
                          'bg-rose-100 text-rose-700'
                        }`
                      }>
                        {currentObjection.difficulty}
                      </span>
                    </div>
                  </div>

                  <p className="text-center text-fm-blue/70 mb-6">Facilitator: award points based on the rebuttal quality.</p>
                  <div className="grid grid-cols-4 gap-3">
                    <button onClick={() => awardPoints(activeTeam, 0)}  className="py-4 rounded-lg text-white font-semibold bg-rose-600 hover:bg-rose-700">0 pts<br/><span className="text-xs opacity-90">Poor</span></button>
                    <button onClick={() => awardPoints(activeTeam, 10)} className="py-4 rounded-lg text-white font-semibold bg-amber-500 hover:bg-amber-600">10 pts<br/><span className="text-xs opacity-90">Okay</span></button>
                    <button onClick={() => awardPoints(activeTeam, 20)} className="py-4 rounded-lg text-white font-semibold bg-fm-bright-blue hover:bg-fm-light-blue">20 pts<br/><span className="text-xs opacity-90">Good</span></button>
                    <button onClick={() => awardPoints(activeTeam, 30)} className="py-4 rounded-lg text-white font-semibold bg-fm-dark-teal hover:bg-fm-teal">30 pts<br/><span className="text-xs opacity-90">Excellent</span></button>
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    };

    /* ---------------- Recipe Cards ---------------- */
    const RecipeCards = ({ onBack }) => {
      const [currentObjection, setCurrentObjection] = useState(null);
      const [recipes, setRecipes] = useState({});
      const [editingId, setEditingId] = useState(null);
      const [formData, setFormData] = useState({ ingredients: '', preparation: '', garnish: '' });

      const selectObjection = () => {
        const random = objections[Math.floor(Math.random() * objections.length)];
        setCurrentObjection(random);
        setEditingId(random.id);
        setFormData(recipes[random.id] || { ingredients: '', preparation: '', garnish: '' });
      };
      const saveRecipe = () => {
        if (editingId) {
          setRecipes(prev => ({ ...prev, [editingId]: formData }));
          setEditingId(null); setCurrentObjection(null);
          setFormData({ ingredients: '', preparation: '', garnish: '' });
        }
      };

      return (
        <div className="min-h-screen bg-white">
          <div className="max-w-6xl mx-auto px-6 py-8">
            <button onClick={onBack} className="mb-6 px-4 py-2 rounded-lg border border-fm-med-blue/20 text-fm-blue hover:bg-fm-bright-blue/10">
              ‚Üê Back to Games
            </button>

            <div className="text-center mb-8">
              <h2 className="font-display text-4xl text-fm-blue">Rebuttal Recipe Cards</h2>
              <p className="text-fm-blue/70">Create your perfect rebuttal recipe for each objection</p>
            </div>

            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div className="bg-white rounded-xl2 shadow-card p-8 border border-fm-med-blue/10">
                <h3 className="text-xl font-semibold text-fm-blue mb-4">Create Recipe</h3>

                {!currentObjection ? (
                  <button onClick={selectObjection}
                          className="w-full py-5 rounded-lg text-white font-semibold bg-fm-bright-blue hover:bg-fm-light-blue">
                    Draw Random Objection
                  </button>
                ) : (
                  <div>
                    <div className="rounded-lg p-4 mb-6 bg-fm-bright-blue/5 border border-fm-med-blue/10">
                      <p className="text-xs text-fm-blue/70 mb-1">Objection:</p>
                      <p className="text-lg font-semibold text-fm-med-blue">‚Äú{currentObjection.text}‚Äù</p>
                    </div>

                    <div className="space-y-4">
                      <div>
                        <label className="block text-sm font-semibold text-fm-blue mb-2">ü•ò Ingredients (Key Points)</label>
                        <textarea value={formData.ingredients}
                                  onChange={(e) => setFormData({...formData, ingredients: e.target.value})}
                                  className="w-full p-3 rounded-lg border border-fm-med-blue/20 focus:border-fm-bright-blue focus:outline-none"
                                  rows="3" placeholder="Acknowledge concern, present data, show long-term value‚Ä¶" />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-fm-blue mb-2">üë®‚Äçüç≥ Preparation (Tone & Approach)</label>
                        <textarea value={formData.preparation}
                                  onChange={(e) => setFormData({...formData, preparation: e.target.value})}
                                  className="w-full p-3 rounded-lg border border-fm-med-blue/20 focus:border-fm-bright-blue focus:outline-none"
                                  rows="3" placeholder="Empathetic tone, use numbers confidently, build urgency‚Ä¶" />
                      </div>
                      <div>
                        <label className="block text-sm font-semibold text-fm-blue mb-2">‚ú® Garnish (Closing Question)</label>
                        <textarea value={formData.garnish}
                                  onChange={(e) => setFormData({...formData, garnish: e.target.value})}
                                  className="w-full p-3 rounded-lg border border-fm-med-blue/20 focus:border-fm-bright-blue focus:outline-none"
                                  rows="2" placeholder="Would you like me to show you the exact savings?" />
                      </div>

                      <div className="flex gap-3">
                        <button onClick={saveRecipe} className="flex-1 py-3 rounded-lg text-white font-semibold bg-fm-dark-teal hover:bg-fm-teal">Save Recipe</button>
                        <button onClick={() => { setCurrentObjection(null); setEditingId(null); }}
                                className="px-6 py-3 rounded-lg text-fm-blue font-semibold border border-fm-med-blue/20 hover:bg-fm-bright-blue/10">
                          Cancel
                        </button>
                      </div>
                    </div>
                  </div>
                )}
              </div>

              <div className="bg-white rounded-xl2 shadow-card p-8 border border-fm-med-blue/10">
                <h3 className="text-xl font-semibold text-fm-blue mb-4">
                  Your Recipe Book ({Object.keys(recipes).length})
                </h3>

                <div className="space-y-4 max-h-96 overflow-y-auto">
                  {Object.keys(recipes).length === 0 ? (
                    <p className="text-fm-blue/60 text-center py-10">
                      No recipes yet. Start by drawing an objection!
                    </p>
                  ) : (
                    Object.entries(recipes).map(([id, recipe]) => {
                      const obj = objections.find(o => o.id === parseInt(id));
                      return (
                        <div key={id} className="rounded-lg p-4 border border-fm-med-blue/15 hover:border-fm-bright-blue/40 transition">
                          <p className="font-semibold text-fm-med-blue mb-2">‚Äú{obj?.text}‚Äù</p>
                          <div className="text-sm space-y-2 text-fm-blue/80">
                            <p><span className="font-semibold text-fm-blue">ü•ò Ingredients:</span> {recipe.ingredients}</p>
                            <p><span className="font-semibold text-fm-blue">üë®‚Äçüç≥ Preparation:</span> {recipe.preparation}</p>
                            <p><span className="font-semibold text-fm-blue">‚ú® Garnish:</span> {recipe.garnish}</p>
                          </div>
                        </div>
                      );
                    })
                  )}
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    /* ---------------- Family Feud ---------------- */
    const FamilyFeud = ({ onBack }) => {
      const [currentQuestion, setCurrentQuestion] = useState(0);
      const [revealed, setRevealed] = useState([]);
      const [score, setScore] = useState(0);

      const questions = [
        { question: 'Top 5 things to tell a borrower who wants to wait for the Fed to cut rates:',
          answers: [
            { text: "Fed rate cuts don't directly equal lower mortgage rates", points: 30 },
            { text: "Mortgage rates often move before Fed announcements", points: 25 },
            { text: "Markets have already priced in expected cuts", points: 20 },
            { text: "Rates may not drop or could go higher", points: 15 },
            { text: "Can refinance again if rates drop significantly", points: 10 }
          ]
        },
        { question: 'Top 5 common streamline objections:',
          answers: [
            { text: "I want to wait for rates to go down more", points: 45 },
            { text: "The savings is not enough", points: 25 },
            { text: "I don't want to pay cost", points: 15 },
            { text: "I'm not interested", points: 10 },
            { text: "I need to speak with my spouse", points: 5 }
          ]
        }
      ];

      const revealAnswer = (index) => {
        if (!revealed.includes(index)) {
          setRevealed(prev => [...prev, index]);
          setScore(score + questions[currentQuestion].answers[index].points);
        }
      };
      const nextQuestion = () => {
        if (currentQuestion < questions.length - 1) {
          setCurrentQuestion(currentQuestion + 1); setRevealed([]);
        }
      };

      return (
        <div className="min-h-screen bg-white">
          <div className="max-w-5xl mx-auto px-6 py-8">
            <button onClick={onBack} className="mb-6 px-4 py-2 rounded-lg border border-fm-med-blue/20 text-fm-blue hover:bg-fm-bright-blue/10">
              ‚Üê Back to Games
            </button>

            <div className="text-center mb-8">
              <h2 className="font-display text-4xl text-fm-blue">Family Feud</h2>
              <div className="inline-block mt-3 rounded-xl2 px-6 py-3 bg-fm-gold/15 text-fm-gold font-semibold">
                SCORE: {score}
              </div>
            </div>

            <div className="rounded-xl2 p-8 mb-8 bg-fm-blue text-white shadow-card">
              <h3 className="text-2xl font-semibold text-center mb-8">{questions[currentQuestion].question}</h3>
              <div className="space-y-3">
                {questions[currentQuestion].answers.map((answer, idx) => (
                  <button key={idx} onClick={() => revealAnswer(idx)}
                          className={`w-full p-5 rounded-xl2 text-left flex items-center justify-between transition ${
                            revealed.includes(idx) ? 'bg-fm-gold/20 text-white' : 'bg-fm-med-blue hover:bg-fm-bright-blue'
                          }`}>
                    <div className="flex items-center gap-4">
                      <span className="text-xl font-bold bg-white text-fm-blue w-10 h-10 rounded-full flex items-center justify-center">
                        {idx + 1}
                      </span>
                      <span className="text-lg font-semibold">{revealed.includes(idx) ? answer.text : '???'}</span>
                    </div>
                    {revealed.includes(idx) && <span className="text-2xl font-bold">{answer.points}</span>}
                  </button>
                ))}
              </div>
            </div>

            {currentQuestion < questions.length - 1 && (
              <div className="text-center">
                <button onClick={nextQuestion}
                        className="px-10 py-4 rounded-lg text-white font-semibold bg-fm-gold hover:brightness-110">
                  Next Question
                </button>
              </div>
            )}
          </div>
        </div>
      );
    };

    /* ---------------- Millionaire ---------------- */
    const Millionaire = ({ onBack }) => {
      const [currentQuestion, setCurrentQuestion] = useState(0);
      const [score, setScore] = useState(0);
      const [gameOver, setGameOver] = useState(false);
      const [lifelines, setLifelines] = useState({ fiftyFifty: true, poll: true });
      const [removedAnswers, setRemovedAnswers] = useState([]);
      const [showPoll, setShowPoll] = useState(false);

      const questions = [
        { value: 100, question: 'When a customer says "I\'m selling my home soon," what should you ask first?', answers: ['What is their timeline and have they listed yet?', 'Tell them refinancing isn\'t worth it', 'End the call immediately', 'Ask about their credit score'], correct: 0 },
        { value: 500, question: 'What\'s the best approach when someone says "I need to speak with my spouse"?', answers: ['Call back next week', 'Show understanding and attempt to have the spouse join the call', 'Send an email and wait', 'Tell them to decide alone'], correct: 1 },
        { value: 1000, question: 'Customer says "I want to wait for rates to go down more." What\'s the strongest rebuttal?', answers: ['Rates might continue to go up', 'Advise there\'s no guarantee rates will drop, and show the cost of waiting vs acting now', 'Tell them they\'re making a mistake', 'Agree and call back later'], correct: 1 },
        { value: 5000, question: 'When hearing "I received a better offer from another lender," you should FIRST:', answers: ['Immediately lower your rate', 'Ask questions about the offer to compare - rate, costs, closing time, and service', 'Tell them the other lender is lying', 'Give up and move to next call'], correct: 1 },
        { value: 10000, question: 'Customer says "The savings is not enough." What\'s the most effective response?', answers: ['30 year pivot or discuss interest savings and term reduction benefits', 'Argue about the monthly amount', 'Offer a lower rate you can\'t deliver', 'Agree and end the call'], correct: 0 }
      ];

      const useFiftyFifty = () => {
        if (!lifelines.fiftyFifty) return;
        const correct = questions[currentQuestion].correct;
        const wrong = [0,1,2,3].filter(i => i !== correct);
        const toRemove = wrong.sort(() => Math.random() - 0.5).slice(0, 2);
        setRemovedAnswers(toRemove);
        setLifelines({...lifelines, fiftyFifty: false});
      };
      const usePoll = () => {
        if (!lifelines.poll) return;
        setShowPoll(true);
        setLifelines({...lifelines, poll: false});
      };
      const handleAnswer = (index) => {
        if (index === questions[currentQuestion].correct) {
          setScore(score + questions[currentQuestion].value);
          if (currentQuestion < questions.length - 1) {
            setCurrentQuestion(currentQuestion + 1);
            setRemovedAnswers([]); setShowPoll(false);
          } else setGameOver(true);
        } else setGameOver(true);
      };
      const restart = () => {
        setCurrentQuestion(0); setScore(0); setGameOver(false);
        setLifelines({ fiftyFifty: true, poll: true }); setRemovedAnswers([]); setShowPoll(false);
      };
      const moneyLadder = [100, 500, 1000, 5000, 10000];

      return (
        <div className="min-h-screen bg-white">
          <div className="max-w-6xl mx-auto px-6 py-8">
            <button onClick={onBack} className="mb-6 px-4 py-2 rounded-lg border border-fm-med-blue/20 text-fm-blue hover:bg-fm-bright-blue/10">
              ‚Üê Back to Games
            </button>

            <div className="text-center mb-8">
              <h2 className="font-display text-4xl text-fm-blue">Who Wants to be a Millionaire?</h2>
            </div>

            {gameOver ? (
              <div className="bg-white rounded-xl2 shadow-card p-12 text-center border border-fm-med-blue/10">
                <h3 className="text-3xl font-semibold text-fm-blue mb-4">{score === 16600 ? 'Congratulations!' : 'Game Over!'}</h3>
                <p className="text-5xl font-bold text-fm-gold mb-6">${score}</p>
                <button onClick={restart} className="px-10 py-4 rounded-lg text-white font-semibold bg-fm-bright-blue hover:bg-fm-light-blue">
                  Play Again
                </button>
              </div>
            ) : (
              <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <div className="lg:col-span-3">
                  <div className="rounded-xl2 p-8 mb-6 bg-fm-blue text-white shadow-card">
                    <p className="text-fm-gold text-xl font-semibold mb-5">Question {currentQuestion + 1} ‚Äî ${questions[currentQuestion].value}</p>
                    <p className="text-2xl font-semibold mb-8">{questions[currentQuestion].question}</p>
                    <div className="grid grid-cols-2 gap-4">
                      {questions[currentQuestion].answers.map((answer, idx) => (
                        <button key={idx}
                                onClick={() => handleAnswer(idx)}
                                disabled={removedAnswers.includes(idx)}
                                className={`p-5 rounded-lg text-left text-base font-semibold transition ${
                                  removedAnswers.includes(idx)
                                    ? 'bg-slate-600 text-slate-300 cursor-not-allowed'
                                    : 'bg-fm-med-blue hover:bg-fm-bright-blue'
                                }`}>
                          <span className="text-fm-gold mr-2">{['A:', 'B:', 'C:', 'D:'][idx]}</span>{answer}
                        </button>
                      ))}
                    </div>

                    {showPoll && (
                      <div className="mt-6 bg-white rounded-lg p-4 text-fm-blue">
                        <p className="font-semibold mb-2">Audience Poll:</p>
                        <div className="space-y-2">
                          {questions[currentQuestion].answers.map((answer, idx) => (
                            <div key={idx} className="flex items-center gap-2">
                              <span className="w-6">{['A','B','C','D'][idx]}</span>
                              <div className="flex-1 bg-slate-200 rounded-full h-5 overflow-hidden">
                                <div className="bg-fm-bright-blue h-5" style={{width: `${idx === questions[currentQuestion].correct ? '75%' : '8%'}`}}></div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    )}
                  </div>

                  <div className="flex gap-4 justify-center">
                    <button onClick={useFiftyFifty}
                            disabled={!lifelines.fiftyFifty}
                            className={`px-6 py-3 rounded-lg font-semibold ${lifelines.fiftyFifty ? 'bg-fm-gold text-white hover:brightness-110' : 'bg-slate-500 text-slate-300 cursor-not-allowed'}`}>
                      50:50
                    </button>
                    <button onClick={usePoll}
                            disabled={!lifelines.poll}
                            className={`px-6 py-3 rounded-lg font-semibold ${lifelines.poll ? 'bg-fm-dark-teal text-white hover:bg-fm-teal' : 'bg-slate-500 text-slate-300 cursor-not-allowed'}`}>
                      Ask Audience
                    </button>
                  </div>
                </div>

                <div className="bg-white rounded-xl2 shadow-card p-6 border border-fm-med-blue/10">
                  <h3 className="text-base font-semibold text-fm-blue mb-3 text-center">Money Ladder</h3>
                  <div className="space-y-2">
                    {[...moneyLadder].reverse().map((value, idx) => {
                      const qIdx = moneyLadder.length - 1 - idx;
                      return (
                        <div key={idx}
                             className={`p-3 rounded-lg text-center font-semibold ${
                               qIdx === currentQuestion ? 'bg-fm-gold/20 text-fm-blue' :
                               qIdx < currentQuestion ? 'bg-fm-dark-teal/20 text-fm-dark-teal' :
                               'bg-slate-100 text-slate-600'
                             }`}>
                          ${value}
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    };

    /* ---------------- Drag & Match ---------------- */
    const DragMatch = ({ onBack }) => {
      const [draggedItem, setDraggedItem] = useState(null);
      const [matches, setMatches] = useState({});
      const [score, setScore] = useState(0);

      const items = [
        { id: 1, objection: 'The savings is not enough', category: 'Value', hint: 'Calculate total interest saved' },
        { id: 2, objection: 'I want to wait for rates to drop', category: 'Timing', hint: 'Cost of waiting vs acting now' },
        { id: 3, objection: "I don't want to pay cost", category: 'Cost', hint: 'No cost options or break-even' },
        { id: 4, objection: 'Process seems complicated', category: 'Process', hint: 'Streamline = less paperwork' },
        { id: 5, objection: 'I got a better offer', category: 'Competition', hint: 'Compare total package' }
      ];
      const categories = ['Value','Timing','Cost','Process','Competition'];

      const handleDragStart = (item) => setDraggedItem(item);
      const handleDrop = (category) => {
        if (draggedItem && draggedItem.category === category) {
          setMatches({...matches, [draggedItem.id]: category}); setScore(score + 20);
        }
        setDraggedItem(null);
      };
      const handleDragOver = (e) => e.preventDefault();
      const resetGame = () => { setMatches({}); setScore(0); };

      return (
        <div className="min-h-screen bg-white">
          <div className="max-w-6xl mx-auto px-6 py-8">
            <button onClick={onBack} className="mb-6 px-4 py-2 rounded-lg border border-fm-med-blue/20 text-fm-blue hover:bg-fm-bright-blue/10">
              ‚Üê Back to Games
            </button>

            <div className="text-center mb-8">
              <h2 className="font-display text-4xl text-fm-blue">Drag &amp; Match</h2>
              <p className="text-fm-blue/70 mb-4">Match each objection to its category</p>
              <div className="inline-block px-6 py-2 rounded-full shadow-card border border-fm-med-blue/15">
                <span className="text-xl font-semibold text-fm-med-blue">Score: {score}/100</span>
              </div>
            </div>

            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
              <div className="bg-white rounded-xl2 shadow-card p-8 border border-fm-med-blue/10">
                <h3 className="text-xl font-semibold text-fm-blue mb-4">Objections</h3>
                <div className="space-y-3">
                  {items.filter(i => !matches[i.id]).map(item => (
                    <div key={item.id} draggable onDragStart={() => handleDragStart(item)}
                         className="p-4 rounded-lg cursor-move border border-fm-med-blue/15 hover:border-fm-bright-blue/40 transition bg-fm-bright-blue/10">
                      <p className="font-semibold text-fm-med-blue mb-1">{item.objection}</p>
                      <p className="text-sm text-fm-blue/70">üí° {item.hint}</p>
                    </div>
                  ))}
                  {items.filter(i => !matches[i.id]).length === 0 && (
                    <div className="text-center py-10">
                      <Trophy className="w-20 h-20 mx-auto mb-3 text-fm-gold"/>
                      <p className="text-xl font-semibold text-fm-blue mb-3">Perfect Match!</p>
                      <button onClick={resetGame}
                              className="px-8 py-3 rounded-lg text-white font-semibold bg-fm-bright-blue hover:bg-fm-light-blue">
                        Play Again
                      </button>
                    </div>
                  )}
                </div>
              </div>

              <div className="bg-white rounded-xl2 shadow-card p-8 border border-fm-med-blue/10">
                <h3 className="text-xl font-semibold text-fm-blue mb-4">Categories</h3>
                <div className="space-y-3">
                  {categories.map(category => (
                    <div key={category} onDrop={() => handleDrop(category)} onDragOver={handleDragOver}
                         className="min-h-24 p-4 rounded-lg bg-fm-bright-blue/5 border-2 border-dashed border-fm-med-blue/25 hover:border-fm-bright-blue/60 transition">
                      <p className="text-lg font-semibold text-fm-med-blue mb-2">{category}</p>
                      <div className="space-y-2">
                        {items.filter(i => matches[i.id] === category).map(item => (
                          <div key={item.id} className="p-3 rounded-lg bg-fm-dark-teal text-white">
                            <p className="font-semibold">{item.objection}</p>
                          </div>
                        ))}
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            <div className="mt-8 bg-white rounded-xl2 shadow-card p-6 border border-fm-med-blue/10">
              <h3 className="text-base font-semibold text-fm-blue mb-2">Instructions</h3>
              <p className="text-fm-blue/75">Drag each objection from the left and drop it into the correct category box on the right. Each correct match earns you 20 points.</p>
            </div>
          </div>
        </div>
      );
    };

    /* Mount */
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<GameSelector />);
  </script>
</body>
</html>
